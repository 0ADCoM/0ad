<?xml version="1.0" encoding="utf-8"?>

<!--
==========================================
- Options Window -
==========================================
-->

<objects>
    <script file="gui/modmod/modmod.js"/>

	<!-- Add a translucent black background to fade out the menu page -->
	<object type="image" sprite="ModernFade"/>

	<!-- Settings Window -->
    <object name="modmod" type="image" style="ModernDialog" size="50%-466 50%-316 50%+466 50%+316">
        <!-- Page Title -->
		<object style="ModernLabelText" type="text" size="50%-128 -16 50%+128 16">
			<translatableAttribute id="caption">Modifications</translatableAttribute>
        </object>



        <!-- 1) Select available Mods: Click on a mod to make it appear in the bottom list. -->
		<object name="AvailableMods" type="image" sprite="ModernDarkBoxGold" size="16 16 312 50%-4">
			<object style="ModernLabelText" type="text" size="0 5 100% 25">
				<translatableAttribute id="caption">Available Mods</translatableAttribute>
			</object>

            <!-- List Headers: -->
			<object name="gamesBox" style="ModernList" type="olist" size="0 25 100% 48%" font="sans-stroke-13">
                <action on="SelectionChange">toggleModSelection(); /*see update game selection in the lobby for an example*/</action>

				<def id="modPreview" color="0 60 0" width="25%">
					<translatableAttribute id="heading">Preview</translatableAttribute>
                </def>

				<def id="modName" color="0 60 0" width="25%">
					<translatableAttribute id="heading">Mod Name</translatableAttribute>
                </def>

				<def id="mapType" color="0 128 128" width="16%">
					<translatableAttribute id="heading" context="map">Mod Type</translatableAttribute>
                </def>

                <!-- TODO: Clarify if really needed as the website could also go into the mod's description. -->
                <def id="modSite" color="128 128 128" width="20%">
					<translatableAttribute id="heading">Website</translatableAttribute>
                </def>

				<def id="modDescription" color="128 128 128" width="16%">
                    <translatableAttribute id="heading" context="map">Description</translatableAttribute>
                </def>

				<def id="modTotalSize" color="128 128 128" width="16%">
                    <translatableAttribute id="heading" context="map">Total Size / KB</translatableAttribute>
                </def>

            </object>

            <!-- FILTER -->
			<object name="filterPanel" size="0 0 100% 24">
				<object name="mapSizeFilter"
					type="dropdown"
					style="ModernDropDown"
					size="52%-5 0 68%-10 100%"
					font="sans-bold-13">
					<action on="SelectionChange">applyFilters();</action>
				</object>

				<object name="mapTypeFilter"
					type="dropdown"
					style="ModernDropDown"
					size="68%-5 0 84%-10 100%"
					font="sans-bold-13">
					<action on="SelectionChange">applyFilters();</action>
				</object>

				<object name="playersNumberFilter"
					type="dropdown"
					style="ModernDropDown"
					size="84%-5 0 100% 100%"
					font="sans-bold-13">
					<action on="SelectionChange">applyFilters();</action>
				</object>

				<object type="text" size="22 0 52%-10 100%" text_align="left" textcolor="white">
					<translatableAttribute id="caption">Show full games</translatableAttribute>
				</object>
				<object name="showFullFilter"
					type="checkbox"
					checked="true"
					style="ModernTickBox"
					size="0 0 20 20"
					font="sans-bold-13">
					<action on="Press">applyFilters();</action>
				</object>
			</object>



            <!-- alternative approach: -->
			<repeat count="allModsAvailable.length">
                <object name="allModsAvailable[n]" size="0 25 100% 50" hidden="true">

                    <!-- De-/Activate  TODO if the parent element is pressed then change the bg color + remove the following checkbox: -->
                    <object name="allModsAvailable[n]['isEnabled']_n" size="70% 5 100% 100%+5" type="checkbox" style="ModernTickBox"/>


                    <!-- Mod Name -->
                    <object name="allModsAvailable[n]['name']_n" size="0 0 65% 100%" type="text" style="ModernLabelText" text_align="right"/>

                    <!-- Website -->
                    <object name="allModsAvailable[n]['website']_n" size="70% 5 100% 100%+5" type="text" style="ModernText"/>

                    <!-- Type/Category -->
                    <object name="allModsAvailable[n]['type']_n" size="70% 0 100%-8 100%" type="text" style="ModernText">
                        allModsAvailable[n]['type']
                    </object>

                    <!-- Description -->
                    <object name="allModsAvailable[n]['description']" size="70% 15 100%-8 100%" type="text" style="ModernText">
                        allModsAvailable[n]['Description']
                    </object>


                    <!-- ACTIONS -->
                    <!-- Add to mod loading order list (the list where the activated mods reside in. -->
                    <action on="press">
                        Engine.GetGUIObjectByName("ModLoadingOrder").append(this.clone()); 
                        // TODO: iterate here, checking if the newly to be added candidate already exists to avoid duplicates (though those don't really matter if ordering is equal)!
                    </action>

                    <!-- on hover show detail panel (only for maps!): -->
                    <action on="hover">if (Engine.GetGUIObjectByName("allModsAvailable[n]['type']_n").text ) {
                            Engine.GetGUIObjectByName("MapDetailPanel").hidden = false; 
                        }
                        else { 
                            Engine.GetGUIObjectByName("MapDetailPanel").hidden = true; 
                        }
                    </action>

				</object>
			</repeat>
        </object>


        <!-- 2) Specify the loading order (optional): -->
		<object name="ModLoadingOrder" type="image" sprite="ModernDarkBoxGold" size="320 16 312 100%-52">
			<object style="ModernLabelText" type="text" size="0 5 100% 25">
                <translatableAttribute id="caption">Mod Loading Order</translatableAttribute>
			</object>
			<repeat count="21">
				<object name="graphicsSetting[n]" size="0 25 100% 50" hidden="true">
					<object name="graphicsSettingLabel[n]" size="0 0 65% 100%" type="text" style="ModernLabelText" text_align="right"/>
					<object name="graphicsSettingTickbox[n]" size="70% 5 100% 100%+5" type="checkbox" style="ModernTickBox" hidden="true"/>
					<object name="graphicsSettingInput[n]" size="70% 0 100%-8 100%" type="input" style="ModernInput" hidden="true"/>
                    <!-- ordering buttons: up + down -->
            		<object type="button" style="ModernButtonRed" size="0 100%-25 100% 100%">
                        <translatableAttribute id="caption">up</translatableAttribute>
    	        		<action on="Press">
	    		        	moveUp(this.parent);
            				Engine.SwitchGuiPage("page_pregame.xml");
            			</action>
            		</object>
            		<object type="button" style="ModernButtonRed" size="0 100%-25 100% 100%">
                        <translatableAttribute id="caption">down</translatableAttribute>
    	        		<action on="Press">
	    		        	moveDown(this.parent);
            				Engine.SwitchGuiPage("page_pregame.xml");
            			</action>
            		</object>
                </object>
			</repeat>
        </object>

        

        
        <!-- RIGHT: Hidden Map Details. TODO show if type is a map. -->
		<object name="MapDetailPanel" type="image" sprite="ModernDarkBoxGold" size="620 16 916 100%-16" hidden="true">
			<object style="ModernLabelText" type="text" size="0 5 100% 25">
				<translatableAttribute id="caption">Map Details</translatableAttribute>
			</object>

			<object name="gamesBox" style="ModernList" type="olist" size="0 25 100% 48%" font="sans-stroke-13">
				<action on="SelectionChange">updateGameSelection();</action>
				<def id="name" color="0 60 0" width="27%">
					<translatableAttribute id="heading">Name</translatableAttribute>
				</def>
				<!--<def id="ip" heading="IP" color="0 128 128" width="170"/>-->
				<def id="mapName" color="128 128 128" width="25%">
					<translatableAttribute id="heading">Map Name</translatableAttribute>
				</def>
				<def id="mapSize" color="128 128 128" width="16%">
					<translatableAttribute id="heading" context="map">Size</translatableAttribute>
				</def>
				<def id="mapType" color="0 128 128" width="16%">
					<translatableAttribute id="heading" context="map">Type</translatableAttribute>
				</def>
				<def id="nPlayers" color="0 128 128" width="16%">
					<translatableAttribute id="heading">Players</translatableAttribute>
				</def>
			</object>

			<object name="filterPanel" size="0 0 100% 24">
				<object name="mapSizeFilter"
					type="dropdown"
					style="ModernDropDown"
					size="52%-5 0 68%-10 100%"
					font="sans-bold-13">
					<action on="SelectionChange">applyFilters();</action>
				</object>

				<object name="mapTypeFilter"
					type="dropdown"
					style="ModernDropDown"
					size="68%-5 0 84%-10 100%"
					font="sans-bold-13">
					<action on="SelectionChange">applyFilters();</action>
				</object>

				<object name="playersNumberFilter"
					type="dropdown"
					style="ModernDropDown"
					size="84%-5 0 100% 100%"
					font="sans-bold-13">
					<action on="SelectionChange">applyFilters();</action>
				</object>

				<object type="text" size="22 0 52%-10 100%" text_align="left" textcolor="white">
					<translatableAttribute id="caption">Show full games</translatableAttribute>
				</object>
				<object name="showFullFilter"
					type="checkbox"
					checked="true"
					style="ModernTickBox"
					size="0 0 20 20"
					font="sans-bold-13">
					<action on="Press">applyFilters();</action>
				</object>
			</object>

        </object>


        <!-- Buttons -->
		<object type="button" style="ModernButtonRed" size="320 100%-44 50%-4 100%-16">
			<translatableAttribute id="caption">Cancel</translatableAttribute>
			<action on="Press">closePage();</action>
        </object>

        <!-- Store Configuration once (TODO: Delete on next engine restart. i.e. clear this configuration value on each start!) -->
		<object type="button" style="ModernButtonRed" size="320 100%-44 50%-4 100%-16">
			<translatableAttribute id="caption">Save Configuration</translatableAttribute>
			<action on="Press">; closePage();</action>
        </object>
        
        <!-- Store Default Mod Loading Configuration. -->
		<object type="button" style="ModernButtonRed" size="50%+4 100%-44 612 100%-16">
			<translatableAttribute id="caption">Save</translatableAttribute>
			<action on="Press">Engine.ConfigDB_WriteFile("user", "config/user.cfg");closePage();</action>
        </object>
        -->

    </object>

</objects>
